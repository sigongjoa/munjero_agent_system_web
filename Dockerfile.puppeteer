FROM ghcr.io/puppeteer/puppeteer:latest

# Set environment variables (adjust PUPPETEER_EXECUTABLE_PATH if needed, but usually not with official image)
ENV PUPPETEER_SKIP_CHROMIUM_DOWNLOAD=true \
    PUPPETEER_EXECUTABLE_PATH=/usr/bin/google-chrome
# Official image usually has google-chrome

WORKDIR /app

# Copy package.json and install dependencies
COPY puppeteer_debug_env/package*.json ./
RUN npm install

# Copy worker files
COPY puppeteer_worker/debug_x11.sh ./puppeteer_worker/
COPY puppeteer_worker/worker.js ./
COPY puppeteer_worker/typecast_worker.js ./
COPY puppeteer_worker/chatgpt_worker.js ./
COPY puppeteer_worker/quiz_automation_worker.js ./

CMD ["node", "worker.js"]